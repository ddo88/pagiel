function getParameterByName(n,r=window.location.href){n=n.replace(/[\[\]]/g,"\\$&");n=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)").exec(r);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function VM(){var n=getParameterByName("type"),o=this;return o.currentList=ko.observable(),o.files=ko.observableArray(),o.chordType=ko.observable(n??"piano"),o.isPiano=ko.computed(function(){return"piano"===this.chordType()},o),o.isBass=ko.computed(function(){return"bass"===this.chordType()},o),o.isGuitar=ko.computed(function(){return"guitar"===this.chordType()},o),o.buscar=function(){try{Reveal.destroy()}catch(n){}o.files([]);var n=_.map(o.currentList().Songs,function(n){return n.id}),e=_.map(o.currentList().Songs,function(n){return n.tono});For(n,function(n,r){n=getSync("/api/songs/"+n),n=new Song(n,o);n.tono(e[r]),o.isPiano()?n.chords(transposeChord(n.chords(),n.tono())):o.isBass()?n.chords(transposeChord(n.chordsBass()??"",n.tono())):n.chords(transposeChord(n.chordsGuitar()??"",n.tono())),o.files.push(n)}),loadReveal()},o.init=function(){o.files([]),get("/api/lists/current").done(function(n){n.length&&(o.currentList(n[0]),o.buscar())})},o.init(),o}function loadReveal(){Reveal.initialize({controls:!0,progress:!0,history:!0,center:!0,transition:"slide",dependencies:[{src:"/javascripts/revealjs/lib/js/classList.js",condition:function(){return!document.body.classList}},{src:"/javascripts/revealjs/plugin/markdown/marked.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/markdown/markdown.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/highlight/highlight.js",async:!0,callback:function(){hljs.initHighlightingOnLoad()}},{src:"/javascripts/revealjs/plugin/zoom-js/zoom.js",async:!0},{src:"/javascripts/revealjs/plugin/notes/notes.js",async:!0}]})}$(function(){$("#parallax").remove(),ko.applyBindings(new VM),$("#header").hide()});var transposeChord=function(n,r){var e,o=["C","Cb","C#","D","Db","D#","E","Eb","E#","F","Fb","F#","G","Gb","G#","A","Ab","A#","B","Bb","B#"],i=["Cb","C","C#","Bb","Cb","C","C","C#","D","Db","D","D#","C","Db","D","D","D#","E","Eb","E","F","D","Eb","E","E","E#","F#","E","F","F#","Eb","Fb","F","F","F#","G","Gb","G","G#","F","Gb","G","G","G#","A","Ab","A","A#","G","Ab","A","A","A#","B","Bb","B","C","A","Bb","B","B","B#","C#"],t=n.match(/[^b#][#b]?/g);for(e in t)if(-1!==o.indexOf(t[e])){if(0<r)for(ix=0;ix<r;ix++){var s=3*o.indexOf(t[e])-2+3;t[e]=i[s+1]}if(r<0)for(ix=0;ix>r;ix--){s=3*o.indexOf(t[e])-2+3;t[e]=i[s-1]}}try{return t.join("")}catch(n){return""}};