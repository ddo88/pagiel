var presenter=!1;function VM(){var e=this;return e.currentList=ko.observable(),e.files=ko.observableArray(),e.buscar=function(){try{Reveal.destroy()}catch(e){}e.files([]);var n=_.map(e.currentList().Songs,function(e){return e.id}),r=getImageRamdon(n.length);For(n,function(n,i){var t=getSync("/api/songs/"+n),s=new Song(t,e);s.image=ko.observable("/images/"+r[i]),e.files.push(s)}),loadReveal()},e.init=function(){e.files([]),get("/api/lists/current").done(function(n){n.length&&(e.currentList(n[0]),e.buscar())})},e.init(),loadSocket(),e}function loadSocket(){Core.SocketsIO.Subscribe("presentationEvent",function(e){presenter||Reveal.slide(e.indexh,e.indexv)}),Core.SocketsIO.Subscribe("presenterSelect",function(){presenter||$("#presenter").hide(500)})}function loadReveal(){Reveal.initialize({minScale:.2,maxScale:1.5,controls:!0,progress:!0,history:!0,center:!0,transition:"slide",dependencies:[{src:"/javascripts/revealjs/lib/js/classList.js",condition:function(){return!document.body.classList}},{src:"/javascripts/revealjs/plugin/markdown/marked.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/markdown/markdown.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/highlight/highlight.js",async:!0,callback:function(){hljs.initHighlightingOnLoad()}},{src:"/javascripts/revealjs/plugin/zoom-js/zoom.js",async:!0},{src:"/javascripts/revealjs/plugin/notes/notes.js",async:!0}]})}$(function(){ko.applyBindings(new VM),$("#presenter").on("click",presenterClick),$("#header").hide()});var presenterClick=_.once(function(){presenter=!0,Core.SocketsIO.Send("presenterSel"),Reveal.addEventListener("slidechanged",function(e){Core.SocketsIO.Send("commandEvent",{previous:e.previousSlide,current:e.currentSlide,indexh:e.indexh,indexv:e.indexv})})});