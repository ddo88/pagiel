var presenter=!1;function VM(){var i=this;return i.currentList=ko.observable(),i.files=ko.observableArray(),i.buscar=function(){try{Reveal.destroy()}catch(e){}i.files([]);var e=_.map(i.currentList().Songs,function(e){return e.id}),r=getImageRamdon(e.length);For(e,function(e,n){e=getSync("/api/songs/"+e),e=new Song(e,i);e.image=ko.observable("/images/"+r[n]),i.files.push(e)}),loadReveal()},i.init=function(){i.files([]),get("/api/lists/current").done(function(e){e.length&&(i.currentList(e[0]),i.buscar())})},i.init(),loadSocket(),i}function loadSocket(){Core.SocketsIO.Subscribe("presentationEvent",function(e){presenter||Reveal.slide(e.indexh,e.indexv)}),Core.SocketsIO.Subscribe("presenterSelect",function(){presenter||$("#presenter").hide(500)})}function loadReveal(){Reveal.initialize({minScale:.2,maxScale:1.5,controls:!0,progress:!0,history:!0,center:!0,zoomKey:"alt",width:"100%",height:"100%",transition:"slide",dependencies:[{src:"/javascripts/revealjs/lib/js/classList.js",condition:function(){return!document.body.classList}},{src:"/javascripts/revealjs/plugin/markdown/marked.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/markdown/markdown.js",condition:function(){return!!document.querySelector("[data-markdown]")}},{src:"/javascripts/revealjs/plugin/highlight/highlight.js",async:!0,callback:function(){hljs.initHighlightingOnLoad()}},{src:"/javascripts/revealjs/plugin/zoom-js/zoom.js",async:!0},{src:"/javascripts/revealjs/plugin/notes/notes.js",async:!0}]})}$(function(){ko.applyBindings(new VM),$("#presenter").on("click",presenterClick),$("#header").hide()});var presenterClick=_.once(function(){presenter=!0,Core.SocketsIO.Send("presenterSel"),Reveal.addEventListener("slidechanged",function(e){Core.SocketsIO.Send("commandEvent",{previous:e.previousSlide,current:e.currentSlide,indexh:e.indexh,indexv:e.indexv})})});